<ng-container *ngIf="job; else cargandoTemplate">
  <!-- â”€â”€â”€ Hero con tÃ­tulo, subtÃ­tulo e imagen/logo si existe â”€â”€â”€ -->
  <section class="detail-hero" style="background: linear-gradient(135deg, #1a1b26 0%, #24283b 100%); color: #ffffff; padding: 3rem 1rem; text-align: center;">
    <h1 class="detail-hero__title" style="font-size: clamp(2rem, 5vw, 3rem); font-weight: 700; margin-bottom: 0.5rem;">
      {{ job.titulo }}
    </h1>
    <p class="detail-hero__subtitle" style="font-size: 1.1rem; color: #a9b1d6; margin-bottom: 1rem;">
      ğŸ¢ {{ job.empresa }} &nbsp;â€¢&nbsp; ğŸŒ {{ job.ubicacion }}
    </p>
    <div *ngIf="job.logoUrl" style="margin-bottom: 1rem;">
      <!-- Si envÃ­as una URL de logo, la mostramos -->
      <img [src]="job.logoUrl"
           alt="{{ job.empresa }} logo"
           style="max-width: 120px; max-height: 120px; object-fit: contain; border-radius: 0.5rem; border: 2px solid rgba(255,255,255,0.3);" />
    </div>
    <span class="detail-hero__badge" style="display: inline-block; background-color: #7aa2f7; color: #1e1e2e; padding: 0.4rem 0.8rem; border-radius: 0.3rem; font-weight: 600;">
      ğŸ“‘ {{ job.tipo.replace('_', ' ') }}
    </span>
  </section>

  <div class="detail-content" style="max-width: 900px; margin: 2rem auto; padding: 1rem; background-color: #24283b; border-radius: 0.6rem; color: #c0caf5; box-shadow: 0 4px 10px rgba(0,0,0,0.5);">
    <!-- â”€â”€â”€ DescripciÃ³n â”€â”€â”€ -->
    <h2 style="color: #ffffff; font-size: 1.5rem; margin-bottom: 0.75rem;">DescripciÃ³n</h2>
    <p style="line-height: 1.6; margin-bottom: 1.5rem;">{{ job.descripcion }}</p>

    <!-- â”€â”€â”€ InformaciÃ³n bÃ¡sica y metadatos â”€â”€â”€ -->
    <div class="detail-meta" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
      <div style="background-color: #292e42; padding: 0.8rem 1rem; border-radius: 0.3rem;">
        <strong>ğŸ’° Sueldo:</strong><br />
        ${{ job.sueldo | number }}
      </div>

      <div style="background-color: #292e42; padding: 0.8rem 1rem; border-radius: 0.3rem;">
        <strong>ğŸ“… Publicado:</strong><br />
        {{ job.fechaPublicacion | date:'longDate' }}
      </div>

      <div *ngIf="job.fechaLimitePostulacion" style="background-color: #292e42; padding: 0.8rem 1rem; border-radius: 0.3rem;">
        <strong>â³ LÃ­mite postulaciÃ³n:</strong><br />
        {{ job.fechaLimitePostulacion | date:'longDate' }}
      </div>

      <div *ngIf="job.nivelExperiencia" style="background-color: #292e42; padding: 0.8rem 1rem; border-radius: 0.3rem;">
        <strong>ğŸ“ Nivel experiencia:</strong><br />
        {{ job.nivelExperiencia }}
      </div>

      <div *ngIf="job.categoria" style="background-color: #292e42; padding: 0.8rem 1rem; border-radius: 0.3rem;">
        <strong>ğŸ· CategorÃ­a:</strong><br />
        {{ job.categoria }}
      </div>

      <div *ngIf="job.departamento" style="background-color: #292e42; padding: 0.8rem 1rem; border-radius: 0.3rem;">
        <strong>ğŸ“Œ Departamento:</strong><br />
        {{ job.departamento }}
      </div>

      <div *ngIf="job.vacantes !== undefined" style="background-color: #292e42; padding: 0.8rem 1rem; border-radius: 0.3rem;">
        <strong>ğŸ‘¥ Vacantes:</strong><br />
        {{ job.vacantes }}
      </div>

      <div *ngIf="job.remoto !== undefined" style="background-color: #292e42; padding: 0.8rem 1rem; border-radius: 0.3rem;">
        <strong>ğŸŒ Remoto:</strong><br />
        {{ job.remoto ? 'SÃ­' : 'No' }}
      </div>

      <div *ngIf="job.duracionContrato" style="background-color: #292e42; padding: 0.8rem 1rem; border-radius: 0.3rem;">
        <strong>â± DuraciÃ³n contrato:</strong><br />
        {{ job.duracionContrato }}
      </div>
    </div>

    <!-- â”€â”€â”€ Campos de texto largos (requisitos, habilidades, beneficios, idiomas) â”€â”€â”€ -->
    <div *ngIf="job.requisitos" style="margin-bottom: 1.5rem;">
      <h3 style="color: #ffffff; margin-bottom: 0.5rem;">ğŸ“ Requisitos</h3>
      <p style="background: #292e42; padding: 0.8rem 1rem; border-radius: 0.3rem; line-height: 1.5;">
        {{ job.requisitos }}
      </p>
    </div>

    <div *ngIf="job.habilidadesRequeridas" style="margin-bottom: 1.5rem;">
      <h3 style="color: #ffffff; margin-bottom: 0.5rem;">ğŸ›  Habilidades requeridas</h3>
      <p style="background: #292e42; padding: 0.8rem 1rem; border-radius: 0.3rem; line-height: 1.5;">
        {{ job.habilidadesRequeridas }}
      </p>
    </div>

    <div *ngIf="job.beneficios" style="margin-bottom: 1.5rem;">
      <h3 style="color: #ffffff; margin-bottom: 0.5rem;">ğŸ Beneficios</h3>
      <p style="background: #292e42; padding: 0.8rem 1rem; border-radius: 0.3rem; line-height: 1.5;">
        {{ job.beneficios }}
      </p>
    </div>

    <div *ngIf="job.idiomas" style="margin-bottom: 1.5rem;">
      <h3 style="color: #ffffff; margin-bottom: 0.5rem;">ğŸ—£ Idiomas</h3>
      <p style="background: #292e42; padding: 0.8rem 1rem; border-radius: 0.3rem; line-height: 1.5;">
        {{ job.idiomas }}
      </p>
    </div>

    <!-- â”€â”€â”€ Enlaces (sitio web y etiquetas) â”€â”€â”€ -->
    <div class="detail-links" style="display: flex; flex-wrap: wrap; gap: 1rem; margin-bottom: 2rem;">
      <a *ngIf="job.companyWebsite"
         [href]="job.companyWebsite"
         target="_blank"
         rel="noopener"
         style="background: #7aa2f7; color: #1e1e2e; padding: 0.6rem 1rem; border-radius: 0.3rem; text-decoration: none; font-weight: 600;">
        ğŸ”— Ver sitio de la empresa
      </a>

      <div *ngIf="job.etiquetas" style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
        <span *ngFor="let tag of (job.etiquetas.split(',') || [])"
              style="background-color: #c678dd; color: #1e1e2e; padding: 0.4rem 0.8rem; border-radius: 0.3rem; font-size: 0.9rem;">
          ğŸ”– {{ tag.trim() }}
        </span>
      </div>
    </div>

    <!-- â”€â”€â”€ BotÃ³n â€œVolver a ofertasâ€ â”€â”€â”€ -->
    <button (click)="volver()"
            class="btn btn-secondary"
            style="background-color: #c678dd; color: #1e1e2e; padding: 0.6rem 1.2rem; border-radius: 0.3rem; font-weight: 600; transition: background-color 0.2s, transform 0.1s; margin-right: 1rem;">
      â† Volver a ofertas
    </button>

    <!-- â”€â”€â”€ Ãrea de Postular o â€œIngresa para postularâ€ â”€â”€â”€ -->
    <div class="detail-apply" style="display: inline-block; margin-left: 1rem;">
      <!-- Si NO estÃ¡ logueado, muestro â€œIngresa para postularâ€ -->
      <button *ngIf="!auth.isLoggedIn(); else loggedInBlock"
              routerLink="/ingreso-profesional"
              class="btn btn-secondary"
              style="background-color: #7aa2f7; color: #1e1e2e; padding: 0.6rem 1.2rem; border-radius: 0.3rem; font-weight: 600;">
        ğŸ” Ingresa para postular
      </button>

      <!-- Si estÃ¡ logueado, muestro â€œPostularâ€ o â€œYa postulasteâ€ -->
      <ng-template #loggedInBlock>
        <button *ngIf="!yaPostulado"
                class="btn btn-primary"
                (click)="apply(job.id)"
                style="background-color: #7aa2f7; color: #1e1e2e; padding: 0.6rem 1.2rem; border-radius: 0.3rem; font-weight: 600;">
          ğŸ“© Postular
        </button>
        <div *ngIf="yaPostulado"
             style="display: inline-block; background-color: #03dac6; color: #1e1e2e; padding: 0.6rem 1rem; border-radius: 0.3rem; font-weight: 600;">
          âœ” Ya postulaste
        </div>
      </ng-template>
    </div>
  </div>
</ng-container>

<ng-template #cargandoTemplate>
  <p style="text-align: center; padding: 2rem; color: #a9b1d6;">Cargando ofertaâ€¦</p>
</ng-template>

<!-- â”€â”€â”€ â€œTOASTâ€ DE Ã‰XITO / ERROR (abajo a la derecha) â”€â”€â”€ -->
<div *ngIf="mensajeToast"
     style="position: fixed; bottom: 1.5rem; right: 1.5rem; background: #03dac6; color: #1e1e2e; padding: 0.8rem 1rem; border-radius: 0.3rem; box-shadow: 0 2px 6px rgba(0,0,0,0.3); font-weight: 600;">
  {{ mensajeToast }}
</div>
